<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>USDC Balance Check - Base Sepolia</title>
    <script src="https://cdn.jsdelivr.net/npm/ethers@5.8.0/dist/ethers.umd.min.js"></script>
    <style>
      body {
        font-family: Arial, sans-serif;
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
        background: #1a1a1a;
        color: #fff;
      }
      .container {
        background: #2a2a2a;
        padding: 20px;
        border-radius: 10px;
        margin: 20px 0;
      }
      button {
        background: #007acc;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 5px;
        cursor: pointer;
        margin: 10px 5px;
      }
      button:hover {
        background: #005a9e;
      }
      .result {
        background: #333;
        padding: 15px;
        border-radius: 5px;
        margin: 10px 0;
        white-space: pre-wrap;
        font-family: monospace;
      }
      .success {
        border-left: 4px solid #4caf50;
      }
      .error {
        border-left: 4px solid #f44336;
      }
      .warning {
        border-left: 4px solid #ff9800;
      }
    </style>
  </head>
  <body>
    <h1>ü™ô USDC Balance Check - Base Sepolia</h1>

    <div class="container">
      <h3>Check USDC Balance</h3>
      <button onclick="checkUSDCBalance()">Check USDC Balance</button>
      <button onclick="getTestUSDC()">Get Test USDC (if available)</button>
      <div id="balanceResult" class="result"></div>
    </div>

    <script>
      const USDC_BASE_SEPOLIA = "0x036CbD53842c5426634e7929541eC2318f3dCF7e";
      const BASE_SEPOLIA_RPC = "https://sepolia.base.org";

      // ERC-20 ABI (minimal)
      const ERC20_ABI = [
        "function balanceOf(address owner) view returns (uint256)",
        "function decimals() view returns (uint8)",
        "function symbol() view returns (string)",
        "function name() view returns (string)",
      ];

      async function checkUSDCBalance() {
        const resultDiv = document.getElementById("balanceResult");

        try {
          if (!window.ethereum) {
            resultDiv.innerHTML = "‚ùå MetaMask not detected";
            resultDiv.className = "result error";
            return;
          }

          await window.ethereum.request({ method: "eth_requestAccounts" });
          const provider = new ethers.providers.Web3Provider(window.ethereum);
          const signer = provider.getSigner();
          const userAddress = await signer.getAddress();

          // Switch to Base Sepolia
          await window.ethereum.request({
            method: "wallet_switchEthereumChain",
            params: [{ chainId: "0x14a34" }],
          });

          resultDiv.innerHTML = "üîç Checking USDC balance on Base Sepolia...";
          resultDiv.className = "result";

          // Create USDC contract instance
          const usdcContract = new ethers.Contract(
            USDC_BASE_SEPOLIA,
            ERC20_ABI,
            provider
          );

          // Get balance
          const balance = await usdcContract.balanceOf(userAddress);
          const decimals = await usdcContract.decimals();
          const symbol = await usdcContract.symbol();
          const name = await usdcContract.name();

          const balanceFormatted = ethers.utils.formatUnits(balance, decimals);

          console.log("ü™ô USDC Balance Check:", {
            userAddress,
            contract: USDC_BASE_SEPOLIA,
            rawBalance: balance.toString(),
            decimals,
            formattedBalance: balanceFormatted,
            symbol,
            name,
          });

          const result = `ü™ô USDC Balance Check Results:

üë§ Wallet Address: ${userAddress}
üí∞ Current USDC Balance: ${balanceFormatted} ${symbol}
üìä Raw Balance (wei): ${balance.toString()}
üî¢ Decimals: ${decimals}
üìù Token Name: ${name}
üìç Contract: ${USDC_BASE_SEPOLIA}

${
  parseFloat(balanceFormatted) < 12
    ? "‚ö†Ô∏è WARNING: Insufficient USDC balance for 12 USDC transfer!"
    : "‚úÖ Sufficient USDC balance for 12 USDC transfer"
}

üí° Need more test USDC? Try:
- Base Sepolia Faucet: https://docs.base.org/docs/tools/network-faucets
- Chainlink Faucet: https://faucets.chain.link/base-sepolia`;

          resultDiv.innerHTML = result;
          resultDiv.className =
            parseFloat(balanceFormatted) < 12
              ? "result warning"
              : "result success";
        } catch (error) {
          console.error("‚ùå Error checking USDC balance:", error);
          resultDiv.innerHTML = `‚ùå Error checking USDC balance: ${error.message}`;
          resultDiv.className = "result error";
        }
      }

      async function getTestUSDC() {
        const resultDiv = document.getElementById("balanceResult");

        resultDiv.innerHTML = `üí° To get test USDC on Base Sepolia:

1. üö∞ Visit Base Sepolia Faucet:
   https://docs.base.org/docs/tools/network-faucets

2. üîó Or Chainlink Faucet:
   https://faucets.chain.link/base-sepolia

3. ü™ô Request test USDC tokens for your address

4. ‚è≥ Wait for confirmation and refresh balance

üìù Your address: ${
          window.ethereum ? "Connect wallet first" : "MetaMask not detected"
        }`;

        resultDiv.className = "result";
      }

      // Auto-check balance on load
      window.addEventListener("load", () => {
        setTimeout(checkUSDCBalance, 1000);
      });
    </script>
  </body>
</html>
